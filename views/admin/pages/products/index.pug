extends ../../layouts/default.pug 
include ../../mixins/filterStatus 
include ../../mixins/formSearch 
include ../../mixins/pagination 
include ../../mixins/alert 
include ../../mixins/sort

block main 
  +alert-success(2000)  

  h1 Danh sách sản phẩm

  .card.mb-3 
    .card-header Bộ lọc và tìm kiếm
    .card-body
      .row.align-items-center
        +filterStatus(filterStatus)        
        +formSearch(keyword)
  
  .card.mb-3 
    .card-header Sắp xếp
    .card-body
      .row
        .col-4
          +sort()

  div.row
    div.col-6
      form(
        action=`/${prefixAdmin}/products/change-multi?_method=PATCH`
        method="POST"
        form-change-multi
      )
        .d-flex.align-items-start
          .form-group
            select(name="type" class="form-control")
              option(disabled selected) --Chọn hành động--
              option(value="active") Hoạt động
              option(value="inactive") Dừng hoạt động
              option(value="delete-all") Xoá tất cả
              option(value="change-position") Thay đổi vị trí
          .form-gruop 
            input(
              type="text"
              name="ids"
              value=""
              class="form-control d-none"
            )
          button(type="submit" class="btn btn-primary") Áp dụng

    div.col-3.modal-trash
      a(
        href="javaScript:;"
        class="btn btn-outline-success"
        trash
      ) Thùng rác

    .col-3
      a(
        href=`/${prefixAdmin}/products/create`
        class="btn btn-outline-success"
        trash
      ) + Thêm mới

      div.modal.d-none
        div.modal-body
          h2 Sản phẩm đã xoá 
          div.modal-content 
            table(
              class="table table-hover table-sm"
            )
              thead 
                tr 
                  th STT 
                  th Hình ảnh
                  th Tiêu đề
                  th Hành động
              tbody  
                each item, index in productDeleted
                  tr 
                    td #{index + 1} 
                    td
                      img(
                        src=item.thumbnail
                        alt=item.title
                        width="100px"
                        height="80px"
                      )
                    td #{item.title}
                    td
                      button(
                        class="bth btn-warning btn-sm"
                        data-id=item.id
                        button-trash
                      ) Khôi phục
          span.close-modal X

  form(
    action=""
    method="POST"
    id="form-restore-item"
    data-path=`/${prefixAdmin}/products/restore`
  )          

  table(
    class="table table-hover table-sm"
    checkbox-multi
  ) 
    thead 
      tr
        th 
          input(type="checkbox" name="checkall")
        th STT
        th Hình ảnh
        th Tiêu đề
        th Giá
        th Vị trí
        th Trạng thái
        th Hành động
    tbody
      each item, index in products
        tr 
          td 
            input(
              type="checkbox"
              name="id"
              value=item.id
            )
          td #{index + 1}
          td 
            img(
              src=item.thumbnail
              alt=item.title
              width="100px"
              height="80px"
            )
          td #{item.title}
          td #{item.price}$
          td
            input(
              class="position"
              type="number"
              value=item.position 
              style="height: 30px"
              min="1"
              name="position"
            )
          td
            if(item.status === "active")
              a(
                href="javaScript:;"
                data-status=item.status
                data-id=item.id
                button-change-status
                class="badge badge-success"
              ) Hoạt động
            else 
              a(
                href="javaScript:;"
                data-status=item.status
                data-id=item.id
                button-change-status
                class="badge badge-danger"
              ) Dừng hoạt động
          td
            a(
              href=`/${prefixAdmin}/products/detail/${item.id}`
            )
              button(
                class="bth btn-secondary btn-sm"
              ) Chi tiết
            a(
              href=`/${prefixAdmin}/products/edit/${item.id}`
            )
              button(
                class="bth btn-warning btn-sm ml-1"
              ) Sửa
            button(
              class="bth btn-danger btn-sm ml-1"
              data-id=item.id
              button-delete
            ) Xoá

  form(
    action=""
    method="POST"
    id="form-delete-item"
    data-path=`/${prefixAdmin}/products/delete`
  )

  +pagination(pagination)

  form(
    action=""
    method="POST"
    id="form-change-status"
    data-path=`/${prefixAdmin}/products/change-status`
  )
  script(src="/admin/js/product.js") 